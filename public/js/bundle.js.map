{"version":3,"sources":["webpack:///webpack/bootstrap 96d8dc08512c6cc01361","webpack:///./src/client/app.js","webpack:///./src/client/application/AudioManager.js","webpack:///./src/client/application/AssetManager.js","webpack:///./src/client/application/KeyboardEventHandler.js"],"names":["socket","io","canvas","document","getElementById","keyEventHandler","audioManager","assetManager","playerId","ctx","spritesLoaded","animate","emit","keyActionsRegister","window","requestAnimationFrame","on","players","clearRect","width","height","Object","keys","forEach","player","key","viewport","areaId","drawImage","getAsset","material","name","position","x","y","blocks","block","i","lives","jumping","init","getContext","queueDownload","loadAll","playSound","downLoadAll","textContent","engine","id","addEventListener","requestAnimFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","element","setTimeout","AudioManager","bufferCache","downloadQueue","succesCount","errorCount","AudioContext","webkitAudioContext","context","e","alert","path","push","length","managerInstance","load","item","url","instance","request","XMLHttpRequest","open","responseType","onload","decodeAudioData","response","buffer","done","onerror","send","loop","sound","createBufferSource","connect","destination","loopEnd","Math","floor","duration","start","AssetManager","cache","img","Image","src","KeyboardEventHandler","initializeKeyHandler","initializeTouchHandler","event","handleTouchStart","handleTouchMove","handleTouchEnd","xDown","yDown","handlerInstance","evt","preventDefault","touches","clientX","clientY","xUp","yUp","xDiff","yDiff"],"mappings":"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","file":"./public/js/bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 96d8dc08512c6cc01361","'use strict'\r\n\r\nimport AudioManager from './application/AudioManager'\r\nimport AssetManager from './application/AssetManager'\r\nimport KeyboardEventHandler from './application/KeyboardEventHandler'\r\n\r\nlet socket = io()\r\nlet canvas = document.getElementById('game')\r\nlet keyEventHandler = new KeyboardEventHandler(canvas)\r\nlet audioManager = new AudioManager() // TODO Combine audio manager with asset manager to avoid duplicate code\r\nlet assetManager = new AssetManager()\r\nlet playerId\r\nlet ctx\r\nlet spritesLoaded = false\r\n\r\nfunction animate () {\r\n  socket.emit('movement', keyEventHandler.keyActionsRegister)\r\n  // Request new frame when ready. Allows the game to play in a loop\r\n  window.requestAnimationFrame(() => animate())\r\n}\r\n\r\nsocket.on('state', players => {\r\n  if (playerId && players[playerId] && spritesLoaded) {\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height)\r\n    Object.keys(players).forEach(key => {\r\n      const player = players[key]\r\n      if (player.viewport.areaId === players[playerId].viewport.areaId) {\r\n        ctx.drawImage(assetManager.getAsset(player.material.name), player.position.x, player.position.y, player.width, player.height)\r\n      }\r\n    })\r\n    players[playerId].viewport.blocks.forEach(block => {\r\n      ctx.drawImage(assetManager.getAsset(block.material.name), block.position.x, block.position.y, block.width, block.height)\r\n    })\r\n    let x = canvas.width - 35\r\n    let y = 5\r\n    for (let i = 0; i < players[playerId].lives; i++) {\r\n      ctx.drawImage(assetManager.getAsset('heart'), x, y, 30, 30)\r\n      x -= 30\r\n    }\r\n    if (players[playerId].jumping) {\r\n      // audioManager.playSound('jump') TODO Make it only fire once while jumping\r\n    }\r\n  }\r\n})\r\n\r\n/**\r\n * Initializes all game Objects\r\n */\r\nfunction init () {\r\n  if (canvas.getContext) {\r\n    socket.emit('new player')\r\n    ctx = canvas.getContext('2d')\r\n    audioManager.queueDownload('ambient', 'assets/audio/ambient/ambient.mp3')\r\n    audioManager.queueDownload('jump', 'assets/audio/effects/jump.wav')\r\n    audioManager.loadAll(() => {\r\n      audioManager.playSound('ambient', true)\r\n\r\n      // Add all sprites to the download queue\r\n      assetManager.queueDownload('background', 'assets/textures/background.png')\r\n      assetManager.queueDownload('player', 'assets/textures/player.png')\r\n      assetManager.queueDownload('stone-block', 'assets/textures/stone-block.jpg')\r\n      assetManager.queueDownload('heart', 'assets/textures/heart.png')\r\n      // Start playing ambient music\r\n\r\n      // Download all sprites\r\n      assetManager.downLoadAll(() => {\r\n        animate()\r\n        // Draw Background only once to improve performance\r\n        document.getElementById('background').getContext('2d').drawImage(assetManager.getAsset('background'), 0, 0, canvas.width, canvas.height)\r\n        spritesLoaded = true\r\n      })\r\n    })\r\n  } else {\r\n    document.getElementById('unsupported').textContent = 'Please update your browser or download another one which supports HTML5'\r\n  }\r\n}\r\n\r\nsocket.on('connect', function () {\r\n  socket.emit('new player')\r\n  playerId = socket.io.engine.id\r\n})\r\n\r\ndocument.addEventListener('DOMContentLoaded', init())\r\n\r\n/**\r\n * Shim for animation loop.\r\n * Selects one that's available or uses fallback with setTimeout.\r\n */\r\nwindow.requestAnimFrame = (function () {\r\n  return window.requestAnimationFrame ||\r\n    window.webkitRequestAnimationFrame ||\r\n    window.mozRequestAnimationFrame ||\r\n    window.oRequestAnimationFrame ||\r\n    window.msRequestAnimationFrame ||\r\n    function (/* function */ callback, /* DOMElement */ element) {\r\n      window.setTimeout(callback, 1000 / 60)\r\n    }\r\n})()\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/app.js","export default class AudioManager {\r\n  constructor () {\r\n    this.bufferCache = []\r\n    this.downloadQueue = []\r\n    this.succesCount = 0\r\n    this.errorCount = 0\r\n\r\n    try {\r\n      // Fix up for prefixing\r\n      window.AudioContext = window.AudioContext || window.webkitAudioContext\r\n      this.context = new AudioContext()\r\n    } catch (e) {\r\n      alert('Web Audio API is not supported in this browser')\r\n    }\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param {string} name\r\n   * @param {string} path\r\n   */\r\n  queueDownload (name, path) {\r\n    this.downloadQueue.push({name: name, path: path})\r\n  }\r\n\r\n  loadAll (callback) {\r\n    if (this.downloadQueue.length === 0) {\r\n      callback()\r\n    }\r\n    let managerInstance = this\r\n    this.downloadQueue.forEach(item => {\r\n      managerInstance.load(item.name, item.path, callback)\r\n    })\r\n  }\r\n\r\n  load (name, url, callback) {\r\n    let instance = this\r\n    let request = new XMLHttpRequest()\r\n\r\n    request.open('GET', url, true)\r\n    request.responseType = 'arraybuffer'\r\n\r\n    // Decode asynchronously\r\n    request.onload = function () {\r\n      instance.context.decodeAudioData(\r\n        request.response, buffer => {\r\n          instance.bufferCache[name] = buffer\r\n          instance.succesCount += 1\r\n\r\n          if (instance.done()) {\r\n            callback()\r\n          }\r\n        }\r\n      )\r\n    }\r\n\r\n    request.onerror = function () {\r\n      instance.errorCount += 1\r\n\r\n      if (instance.done()) {\r\n        callback()\r\n      }\r\n    }\r\n    request.send()\r\n  }\r\n\r\n  playSound (name, loop = false) {\r\n    let sound = this.context.createBufferSource()\r\n\r\n    sound.buffer = this.bufferCache[name]\r\n    sound.connect(this.context.destination)\r\n    if (loop) {\r\n      sound.loop = loop\r\n      sound.loopEnd = Math.floor(sound.buffer.duration)\r\n    }\r\n    sound.start(0)\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @returns {boolean}\r\n   */\r\n  done () {\r\n    return this.downloadQueue.length === this.succesCount + this.errorCount\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/application/AudioManager.js","export default class AssetManager {\n  constructor () {\n    this.downloadQueue = []\n    this.cache = {}\n    this.succesCount = 0\n    this.errorCount = 0\n  }\n\n  /**\n   *\n   * @param {string} name\n   * @param {string} path\n   */\n  queueDownload (name, path) {\n    this.downloadQueue.push({name: name, path: path})\n  }\n\n  /**\n   *\n   * @param callback\n   */\n  downLoadAll (callback) {\n    if (this.downloadQueue.length === 0) {\n      callback()\n    }\n\n    let managerInstance = this\n    this.downloadQueue.forEach(item => {\n      let img = new Image()\n      img.addEventListener('load', () => {\n        managerInstance.succesCount += 1\n\n        if (managerInstance.done()) {\n          callback()\n        }\n      }, false)\n      img.addEventListener('error', function () {\n        managerInstance.errorCount += 1\n\n        if (managerInstance.done()) {\n          callback()\n        }\n      }, false)\n      img.src = item.path\n      this.cache[item.name] = img\n    })\n  }\n\n  /**\n   *\n   * @param {string} name\n   */\n  getAsset (name) {\n    return this.cache[name]\n  }\n\n  /**\n   *\n   * @returns {boolean}\n   */\n  done () {\n    return this.downloadQueue.length === this.succesCount + this.errorCount\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/application/AssetManager.js","/**\r\n * Input manager.\r\n *\r\n * @author Daniel Peters\r\n * @version 2.0\r\n */\r\nexport default class KeyboardEventHandler {\r\n  constructor () {\r\n    this.initializeKeyHandler()\r\n    this.initializeTouchHandler()\r\n\r\n    // All keystrokes and touch swipes are registered here\r\n    // This object is then sent to the server to process player movement\r\n    this.keyActionsRegister = {}\r\n  }\r\n\r\n  /**\r\n   * Handle keyboard key presses.\r\n   * Only booleans are set to express the movement direction intention\r\n   * This allows the separation of keystrokes from actual movement.\r\n   */\r\n  initializeKeyHandler () {\r\n    window.addEventListener('keydown', event => { this.keyActionsRegister[event.key] = true }, false)\r\n    window.addEventListener('keyup', event => { this.keyActionsRegister[event.key] = false }, false)\r\n  }\r\n\r\n  /**\r\n   * Maps swipe directions to key press booleans.\r\n   * Allows touch controls on mobile.\r\n   */\r\n  initializeTouchHandler () {\r\n    window.addEventListener('touchstart', handleTouchStart, false)\r\n    window.addEventListener('touchmove', handleTouchMove, false)\r\n    window.addEventListener('touchend', handleTouchEnd, false)\r\n\r\n    let xDown = null\r\n    let yDown = null\r\n    let handlerInstance = this\r\n\r\n    function handleTouchStart (evt) {\r\n      // Prevent div scrolling\r\n      evt.preventDefault()\r\n      xDown = evt.touches[0].clientX\r\n      yDown = evt.touches[0].clientY\r\n    }\r\n\r\n    function handleTouchMove (evt) {\r\n      // Prevent div scrolling\r\n      evt.preventDefault()\r\n      // do nothing if no touch direction is registered\r\n      if (!xDown || !yDown) {\r\n        return\r\n      }\r\n\r\n      let xUp = evt.touches[0].clientX\r\n      let yUp = evt.touches[0].clientY\r\n\r\n      // Subtract start currently touched location from start location\r\n      let xDiff = xDown - xUp\r\n      let yDiff = yDown - yUp\r\n\r\n      // Positive values equals left. Negative values equals right\r\n      if (xDiff > 0) {\r\n        handlerInstance.keyActionsRegister['a'] = true\r\n      } else {\r\n        handlerInstance.keyActionsRegister['d'] = true\r\n      }\r\n\r\n      // Positive = up. Negative = down\r\n      if (yDiff > 0) {\r\n        handlerInstance.keyActionsRegister['w'] = true\r\n      } else {\r\n        /* down swipe */\r\n      }\r\n      /* reset values */\r\n      xDown = null\r\n      yDown = null\r\n    }\r\n\r\n    function handleTouchEnd (evt) {\r\n      // Prevent div scrolling\r\n      evt.preventDefault()\r\n      Object.keys(handlerInstance.keyActionsRegister).forEach(key => { handlerInstance.keyActionsRegister[key] = false })\r\n    }\r\n  }\r\n\r\n  getKeyActionsRegister () {\r\n    return this.keyActionsRegister\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/application/KeyboardEventHandler.js"],"sourceRoot":""}